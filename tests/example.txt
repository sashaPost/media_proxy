from flask import Flask, request, jsonify

app = Flask(__name__)

# Define your API key
API_KEY = "your_secure_api_key"

# Middleware function to check API key
def check_api_key(func):
    @wraps(func)
    def wrapper(*args, **kwargs):
        if request.headers.get("Authorization") != API_KEY:
            return jsonify({"error": "Unauthorized"}), 401
        return func(*args, **kwargs)
    return wrapper

# Apply middleware to specific routes
@app.route("/upload", methods=["POST"])
@check_api_key
def upload_file():
    # Your upload logic here
    return jsonify({"message": "File uploaded successfully!"})

if __name__ == "__main__":
    app.run(debug=True)
